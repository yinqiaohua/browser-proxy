<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Browser-Proxy UI Panner</title>
<link rel="stylesheet" href="css/bootstrap.css" />
<link rel="stylesheet" href="css/xenon-core.css" />
<link rel="stylesheet" href="css/style.css" />
</head>
<body>


<div class="form-inline filter-control">
  <div class="form-group">
    <div class="input-group">
      <div class="input-group-addon">filter http request</div>
      <input class="form-control" type="text" placeholder="filter here" id="filter-handler" />
    </div>
  </div>
</div>

<div class="panel panel-default detail-layer-pannel" id="layer-pannel" style="display: none;">
  <div class="panel-heading">
    <h3 class="panel-title">Request Detail Pannel</h3>
    <div class="panel-options">
      <a href="javascript:;" id="close-layer-dialog">Ã—</a>
    </div>

  </div>
  <div class="panel-body">
    <h3 id="response-url-title" class="response-url-title"></h3>
    <div class="dataTables_wrapper form-inline dt-bootstrap">
      <div class="row" style="display: none;">
        <div class="col-sm-5"></div>
        <div class="col-sm-7">
          <div class="DTTT_container">
            <a class="DTTT_button"><span>Request Headers</span></a>
            <a class="DTTT_button"><span>Request Params</span></a>
            <a class="DTTT_button"><span>Request Cookies</span></a>

            <a class="DTTT_button"><span>Response Headers</span></a>
            <a class="DTTT_button"><span>Response Content</span></a>
          </div>
        </div>
      </div>

      <div id="response-pannel">

      </div>
    </div>
  </div>
</div>

<table class="table table-small-font table-bordered table-striped request-list">
  <thead>
    <tr>
      <th>#</th>
      <th>Result</th>
      <th>Protocol</th>
      <th>Host</th>
      <th>URL</th>
      <th>ServerIp</th>
      <th>TimeSpend</th>
      <th>FileSize</th>
    </tr>
  </thead>
  <tbody id="data-list"></tbody>
</table>

<!-- request url list template start -->
<script id="tpl-req-list" type="text/html">
{{if useHost}}
<tr class="tr-host-selected" data-id="{{sid}}">
{{else if maplocal}}
<tr class="tr-maplocal-selected" data-id="{{sid}}">
{{else}}
<tr data-id="{{sid}}">
{{/if}}
  <td class="data-index">{{index}}</td>
  <td class="data-status">{{status}}</td>
  <td class="data-protocol">{{protocol}}</td>
  <td class="data-host">{{host}}</td>
  <td class="data-url">{{(url+'').substring(0,80)}}</td>
  <td class="data-serverip"></td>
  <td class="data-timespend">{{serverip}}</td>
  <td class="data-filesize">{{filesize}}</td>
</tr>
</script>
<!-- request url list template end -->

<!-- filter list template start -->
<script id="tpl-filter-list" type="text/html">
{{each dataList as v k}}
  {{if v.useHost}}
  <tr class="tr-host-selected" data-id="{{v.sid}}">
  {{else if v.maplocal}}
  <tr class="tr-maplocal-selected" data-id="{{v.sid}}">
  {{else}}
  <tr data-id="{{v.sid}}">
  {{/if}}
    <td class="data-index">{{v.index}}</td>
    <td class="data-status">{{v.statusCode}}</td>
    <td class="data-protocol">{{v.protocol}}</td>
    <td class="data-host">{{v.host}}</td>
    <td class="data-url">{{(v.pathname+'').substring(0,80)}}</td>
    <td class="data-serverip">{{v.hostname}}</td>
    <td class="data-timespend">{{v.timespend}}</td>
    <td class="data-timespend">{{v.filesize}}</td>
  </tr>
{{/each}}
</script>
<!-- filter list template end -->

<!-- response template start -->
<script id="tpl-req-headers" type="text/html">
<table class="table table-condensed">
  <caption>request headers</caption>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    {{each reqHd as value index}}
    <tr>
      <td style="min-width: 200px">{{index}}</td>
      <td class="wd-break">{{value}}</td>
    </tr>
    {{/each}}
  </tbody>
</table>

<table class="table table-condensed">
  <caption>request query</caption>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    {{each query as value index}}
    <tr>
      <td>{{index}}</td>
      <td class="wd-break">{{value}}</td>
    </tr>
    {{/each}}
  </tbody>
</table>

<div class="clear"></div>

<table class="table table-condensed">
  <caption>request cookies</caption>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    {{each cookies as value index}}
    <tr>
      <td>{{index}}</td>
      <td class="wd-break">{{value}}</td>
    </tr>
    {{/each}}
  </tbody>
</table>

<table class="table table-condensed">
  <caption>response headers</caption>
  <thead>
    <tr>
      <th>Key</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    {{each resHd as value index}}
    <tr>
      <td style="min-width: 200px">{{index}}</td>
      <td class="wd-break">{{value}}</td>
    </tr>
    {{/each}}
  </tbody>
</table>

<div class="response-body">
  <h1>response body</h1>
  <div>
    <pre>{{body}}</pre>
  </div>
</div>
</script>
<!-- response template end -->


<script src="./lib/jquery.min.js"></script>
<script src="./js/arttemplate.js"></script>
<script src="./index.js"></script>


<script src="http://127.0.0.1:9000/socket.io/socket.io.js"></script>
<script>
var lastData;
var socket = io('http://localhost:9000');
socket.on('request', function (data) {
  lastData = data;
  updateRequestData(data);
});

socket.on('response', function (data) {
  updateResponseData(data);
});
</script>
</body>
</html>